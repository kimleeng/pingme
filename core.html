<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>pingme – core</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">pingme</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/kimleeng/pingme/"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-reader-toggle nav-link" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">(Untitled)</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Project name here</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./core.html" class="sidebar-item-text sidebar-link active">PingMe</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./api.html" class="sidebar-item-text sidebar-link">API</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#pingme" id="toc-pingme" class="nav-link active" data-scroll-target="#pingme">PingMe</a>
  <ul class="collapse">
  <li><a href="#set-env-variables-from-file" id="toc-set-env-variables-from-file" class="nav-link" data-scroll-target="#set-env-variables-from-file">Set ENV variables from file</a>
  <ul class="collapse">
  <li><a href="#set_env_variables" id="toc-set_env_variables" class="nav-link" data-scroll-target="#set_env_variables">set_env_variables</a></li>
  </ul></li>
  <li><a href="#notebook-variables" id="toc-notebook-variables" class="nav-link" data-scroll-target="#notebook-variables">Notebook Variables</a></li>
  <li><a href="#pingme-class" id="toc-pingme-class" class="nav-link" data-scroll-target="#pingme-class">PingMe class</a>
  <ul class="collapse">
  <li><a href="#card" id="toc-card" class="nav-link" data-scroll-target="#card">Card</a></li>
  <li><a href="#pingme-1" id="toc-pingme-1" class="nav-link" data-scroll-target="#pingme-1">PingMe</a></li>
  <li><a href="#resolved_payload" id="toc-resolved_payload" class="nav-link" data-scroll-target="#resolved_payload">resolved_payload</a></li>
  <li><a href="#send_to_webhook" id="toc-send_to_webhook" class="nav-link" data-scroll-target="#send_to_webhook">send_to_webhook</a>
  <ul class="collapse">
  <li><a href="#pingme.send_webhook" id="toc-pingme.send_webhook" class="nav-link" data-scroll-target="#pingme.send_webhook">PingMe.send_webhook</a></li>
  </ul></li>
  <li><a href="#send_to_email" id="toc-send_to_email" class="nav-link" data-scroll-target="#send_to_email">send_to_email</a>
  <ul class="collapse">
  <li><a href="#pingme.send_email" id="toc-pingme.send_email" class="nav-link" data-scroll-target="#pingme.send_email">PingMe.send_email</a></li>
  </ul></li>
  <li><a href="#send_to_logfile" id="toc-send_to_logfile" class="nav-link" data-scroll-target="#send_to_logfile">send_to_logfile</a>
  <ul class="collapse">
  <li><a href="#pingme.send_logfile" id="toc-pingme.send_logfile" class="nav-link" data-scroll-target="#pingme.send_logfile">PingMe.send_logfile</a></li>
  <li><a href="#cli" id="toc-cli" class="nav-link" data-scroll-target="#cli">cli</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/kimleeng/pingme/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<section id="pingme" class="level1">
<h1>PingMe</h1>
<p>To install notebook development environment run the following command: <code>conda create env -p ./.venv --file conda.env.yml</code></p>
<p>NOTE: this may not be the nbdev approach but leaving for now, pretty sure I use pip for envs.</p>
<section id="set-env-variables-from-file" class="level2">
<h2 class="anchored" data-anchor-id="set-env-variables-from-file">Set ENV variables from file</h2>
<p>Used for running the notebook in dev mode, not used in sections with <code>#|export</code>.</p>
<hr>
<section id="set_env_variables" class="level4">
<h4 class="anchored" data-anchor-id="set_env_variables">set_env_variables</h4>
<blockquote class="blockquote">
<pre><code> set_env_variables (config_path)</code></pre>
</blockquote>
</section>
</section>
<section id="notebook-variables" class="level2">
<h2 class="anchored" data-anchor-id="notebook-variables">Notebook Variables</h2>
<p>Here you can see included potential variables and their ENV variable names.</p>
</section>
<section id="pingme-class" class="level2">
<h2 class="anchored" data-anchor-id="pingme-class">PingMe class</h2>
<blockquote class="blockquote">
<p>Is used to send notifications to a webhook (designed for use with <a href="https://docs.microsoft.com/en-us/microsoftteams/platform/webhooks-and-connectors/how-to/add-incoming-webhook%20in%20Microsoft%20Teams">incoming webhooks</a>), e-mail, and/or a log file. The class stores a json payload which can have variables for replacement denoted by <code>${key_name}</code>. A payload_context is passed to replace all variables in the payload. As the most common use will be to send a message with a Title/Subject and Text/Body these can be optionally passed and will work with the <code>default_card.json</code> template. For card info and designs see <a href="https://adaptivecards.io/samples/">here</a>.</p>
</blockquote>
<hr>
<section id="card" class="level3">
<h3 class="anchored" data-anchor-id="card">Card</h3>
<blockquote class="blockquote">
<pre><code> Card (name:str, context:dict)</code></pre>
</blockquote>
<p>Create a new model by parsing and validating input data from keyword arguments.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>default_card <span class="op">=</span> Card(name<span class="op">=</span>PINGME_ENV_CARD_NAME, context<span class="op">=</span>PINGME_ENV_CARD_CONTEXT)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(default_card)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="pingme-1" class="level3">
<h3 class="anchored" data-anchor-id="pingme-1">PingMe</h3>
<blockquote class="blockquote">
<pre><code> PingMe (card:__main__.Card, card_dir:pathlib.Path, card_ext:str='.yaml')</code></pre>
</blockquote>
<p>PingMe class which notifies via either a webhook or email</p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>card</td>
<td>Card</td>
<td></td>
<td>Card object</td>
</tr>
<tr class="even">
<td>card_dir</td>
<td>Path</td>
<td></td>
<td>Directory to look for cards in</td>
</tr>
<tr class="odd">
<td>card_ext</td>
<td>str</td>
<td>.yaml</td>
<td>Extension of card file</td>
</tr>
</tbody>
</table>
<p>Functionality to resolve the payload, which means changing the variables and returning it as a <code>str</code> instead of a <code>json</code> object.</p>
<hr>
</section>
<section id="resolved_payload" class="level3">
<h3 class="anchored" data-anchor-id="resolved_payload">resolved_payload</h3>
<blockquote class="blockquote">
<pre><code> resolved_payload (payload:&lt;module'json'from'/opt/hostedtoolcache/Python/3
                   .10.6/x64/lib/python3.10/json/__init__.py'&gt;,
                   context:dict)</code></pre>
</blockquote>
<p>Resolves the payload by substituting variables in the <code>payload</code> with values from the <code>context</code> and ensures all variables are accounted for</p>
<p>Check the notification object loading with defaults and the contents of it</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>notification <span class="op">=</span> PingMe(card<span class="op">=</span>default_card, card_dir<span class="op">=</span>PINGME_ENV_CARD_DIR, card_ext<span class="op">=</span>PINGME_ENV_CARD_EXT)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>notification</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Functionality to send the resolved_payload to a webhook, its split from the class method for the sake of testing.</p>
<hr>
</section>
<section id="send_to_webhook" class="level3">
<h3 class="anchored" data-anchor-id="send_to_webhook">send_to_webhook</h3>
<blockquote class="blockquote">
<pre><code> send_to_webhook (url:str, payload:&lt;module'json'from'/opt/hostedtoolcache/
                  Python/3.10.6/x64/lib/python3.10/json/__init__.py'&gt;, hea
                  der:&lt;module'json'from'/opt/hostedtoolcache/Python/3.10.6
                  /x64/lib/python3.10/json/__init__.py'&gt;={'Content-
                  Type':'application/json'})</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test it fails with a bad url</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> fastcore.test.ExceptionExpected(): send_to_webhook(<span class="st">"https://badhost"</span>, notification.payload)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<section id="pingme.send_webhook" class="level4">
<h4 class="anchored" data-anchor-id="pingme.send_webhook">PingMe.send_webhook</h4>
<blockquote class="blockquote">
<pre><code> PingMe.send_webhook ()</code></pre>
</blockquote>
<p>Basic tests</p>
<p>If there’s an error with this please check if you have a valid <code>WEBHOOK_URL</code> in the config.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note this test will send a request out</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> SEND_WEBHOOK:</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    fastcore.test.test_eq({<span class="st">"status_code"</span>: <span class="dv">200</span>, <span class="st">"response"</span>: <span class="st">'1'</span>}, notification.send_webhook())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Functionality to send the resolved_payload to an e-mail address</p>
<hr>
</section>
</section>
<section id="send_to_email" class="level3">
<h3 class="anchored" data-anchor-id="send_to_email">send_to_email</h3>
<blockquote class="blockquote">
<pre><code> send_to_email (payload:&lt;module'json'from'/opt/hostedtoolcache/Python/3.10
                .6/x64/lib/python3.10/json/__init__.py'&gt;, subject:str,
                from_:str, to:str, host:str, port:int=25, user=None,
                password=None)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test if not provided a proper smtp host</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> fastcore.test.ExceptionExpected(): send_to_email(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    notification.payload,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    notification.title,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    notification.email[<span class="st">"from"</span>],</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    notification.email[<span class="st">"to"</span>],</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://badhost"</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    notification.email[<span class="st">"smtp"</span>][<span class="st">"port"</span>],</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    notification.email[<span class="st">"smtp"</span>][<span class="st">"user"</span>],</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    notification.email[<span class="st">"smtp"</span>][<span class="st">"password"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<section id="pingme.send_email" class="level4">
<h4 class="anchored" data-anchor-id="pingme.send_email">PingMe.send_email</h4>
<blockquote class="blockquote">
<pre><code> PingMe.send_email ()</code></pre>
</blockquote>
<p>If there’s error’s here please check the type of error. ConnectionRefusedError indicates there’s issues with connecting to the SMTP email server.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> SEND_EMAIL:</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    fastcore.test.test_eq({<span class="st">"status_code"</span>: <span class="dv">200</span>, <span class="st">"response"</span>: <span class="va">True</span>}, notification.send_email())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Basic test</p>
<p>!|hide The <a href="https://kimleeng.github.io/pingme/core.html#send_to_logfile">send_to_logfile</a> function right now only sends a title and text, along with a timestamp. This is based off the default card. Some better solution should be found for this in the future. The goal is to not send raw json to the log file as it wont be readable. Perhaps storing each file in a folder and then logging the date and link to file?</p>
<hr>
</section>
</section>
<section id="send_to_logfile" class="level3">
<h3 class="anchored" data-anchor-id="send_to_logfile">send_to_logfile</h3>
<blockquote class="blockquote">
<pre><code> send_to_logfile (logfile:str, title:str, text:str)</code></pre>
</blockquote>
<p>Send message to logfile</p>
<hr>
<section id="pingme.send_logfile" class="level4">
<h4 class="anchored" data-anchor-id="pingme.send_logfile">PingMe.send_logfile</h4>
<blockquote class="blockquote">
<pre><code> PingMe.send_logfile ()</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(notification.logfile[<span class="st">"path"</span>])</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> SEND_LOGFILE:</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    notification.send_logfile()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test if not provided a proper log file</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> fastcore.test.ExceptionExpected(): send_to_log_file(<span class="va">None</span>, notification.title, notification.text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="cli" class="level4">
<h4 class="anchored" data-anchor-id="cli">cli</h4>
<blockquote class="blockquote">
<pre><code> cli (context:str, webhook:bool, email:bool, logfile:bool, example:bool,
      config_file:str=None, card_name:str='default',
      card_dir:str='./cards/', card_ext:str='.yaml')</code></pre>
</blockquote>
<p>PingMe send a notification to a webhook, email, or log file.</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>context</td>
<td>str</td>
<td></td>
<td>string denoting a json object with context variables (e.g.&nbsp;‘{“title”:“Test Title”, “text”:“Test Text”}’)</td>
</tr>
<tr class="even">
<td>webhook</td>
<td>bool</td>
<td></td>
<td>attempts to send to webhook</td>
</tr>
<tr class="odd">
<td>email</td>
<td>bool</td>
<td></td>
<td>attempts to send to email</td>
</tr>
<tr class="even">
<td>logfile</td>
<td>bool</td>
<td></td>
<td>attempts to send to logfile</td>
</tr>
<tr class="odd">
<td>example</td>
<td>bool</td>
<td></td>
<td>Runs with example params, if it doesn’t work config values haven’t been set properly</td>
</tr>
<tr class="even">
<td>config_file</td>
<td>str</td>
<td>None</td>
<td>config file to set env vars from</td>
</tr>
<tr class="odd">
<td>card_name</td>
<td>str</td>
<td>default</td>
<td>Name of the card which matches a card found in {PROJECTDIR}/cards/{CARDNAME}.yaml</td>
</tr>
<tr class="even">
<td>card_dir</td>
<td>str</td>
<td>./cards/</td>
<td>Directory where cards are stored</td>
</tr>
<tr class="odd">
<td>card_ext</td>
<td>str</td>
<td>.yaml</td>
<td>Extension of card files</td>
</tr>
</tbody>
</table>
<p>Test CLI by calling it as a function, should also export and run from command line to check as well.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>cli(config_file<span class="op">=</span>os.environ.get(<span class="st">"PINGME_CONFIG_PATH"</span>), context<span class="op">=</span><span class="st">'{"title":"Test", "text":"This is a test"}'</span>, webhook<span class="op">=</span><span class="va">True</span>, email<span class="op">=</span><span class="va">True</span>, logfile<span class="op">=</span><span class="va">True</span>, example<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>